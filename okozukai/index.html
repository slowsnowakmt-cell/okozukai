<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<title>ã—ã£ã‹ã‚Šï¼ãŠã“ã¥ã‹ã„ãƒ©ã‚¤ãƒ•ï¼ˆå®Œå…¨ãƒ‡ãƒ¢ç‰ˆï¼‰</title>
<style>
body {
  margin: 0;
  font-family: "Rounded Mplus 1c", "Yu Gothic", sans-serif;
  background: url('bg/default.jpg') no-repeat center center;
  background-size: contain;
  background-attachment: scroll;
  background-color: #fff;
  text-align: center;
  transition: background-image 1s ease-in-out;
  color: #333;
}
#game {
  display: none;
  max-width: 480px;
  margin: 40px auto;
  background: rgba(255,255,255,0.9);
  border-radius: 15px;
  padding: 20px;
}
#title {
  height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background: linear-gradient(to bottom, #87cefa, #b3e5ff);
  color: white;
}
#title h1 {
  font-size: 2.4em;
  animation: floatTitle 4s ease-in-out infinite;
  text-shadow: 0 0 8px rgba(0,0,0,0.2);
}
@keyframes floatTitle {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}
#startBtn {
  background: white;
  border: none;
  border-radius: 30px;
  padding: 15px 40px;
  margin-top: 40px;
  font-size: 1.2em;
  color: #3498db;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  cursor: pointer;
  animation: floatBtn 3.5s ease-in-out infinite;
}
@keyframes floatBtn {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(8px); }
}
button {
  background-color: #ffb84c;
  border: none;
  border-radius: 12px;
  color: white;
  padding: 10px 20px;
  margin: 8px;
  cursor: pointer;
  font-size: 16px;
}
button:hover { background-color: #ffa733; }
.stats {
  background: rgba(255,255,255,0.6);
  border-radius: 12px;
  padding: 10px;
  margin-top: 15px;
}
</style>
</head>
<body>

<!-- ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ -->
<div id="title">
  <h1>ã—ã£ã‹ã‚Šï¼ãŠã“ã¥ã‹ã„ãƒ©ã‚¤ãƒ•</h1>
  <button id="startBtn">ã¯ã˜ã‚ã‚‹ï¼</button>
</div>

<!-- ã‚²ãƒ¼ãƒ ç”»é¢ -->
<div id="game">
  <p id="text"></p>
  <div id="choices"></div>
  <div class="stats" id="stats"></div>
</div>

<!-- éŸ³å£°ç´ æ -->
<audio id="bgm-main" src="bgm/main.mp3" loop></audio>
<audio id="bgm-event" src="bgm/event.mp3" loop></audio>
<audio id="bgm-luxury" src="bgm/luxury.mp3" loop></audio>
<audio id="se-click" src="se/click.mp3"></audio>
<audio id="se-buy" src="se/buy.mp3"></audio>
<audio id="se-success" src="se/success.mp3"></audio>
<audio id="se-end" src="se/end.mp3"></audio>

<script>
let month = 4;
let money = 0;
let happy = 0;
let specialGift = false;
let switchBought = false;

const months = ["4æœˆ","5æœˆ","7æœˆ","8æœˆ","12æœˆ"];
const monthOrder = [4,5,7,8,12];

document.getElementById("startBtn").onclick = () => {
  playSe("click");
  document.getElementById("title").style.display = "none";
  document.getElementById("game").style.display = "block";
  playBgm("main");
  startGame();
};

/* ===== éŸ³ç®¡ç† ===== */
function playBgm(type){
  ["main","event","luxury"].forEach(id=>{
    const a=document.getElementById("bgm-"+id);
    a.pause(); a.currentTime=0;
  });
  const bg=document.getElementById("bgm-"+type);
  if(bg){ bg.volume=0.5; bg.play().catch(()=>{}); }
}
function playSe(id){
  const s=document.getElementById("se-"+id);
  if(s){ s.currentTime=0; s.play().catch(()=>{}); }
}

/* ===== èƒŒæ™¯åˆ‡æ›¿ ===== */
function setBackground(type){
  let file;
  if(month===4) file = (type==="event" ? "bg/4_event.jpg" : "bg/4.jpg");
  else if(month===5) file = (type==="event" ? "bg/5_event.jpg" : "bg/5.jpg");
  else file = "bg/default.jpg";
  document.body.style.backgroundImage = `url('${file}')`;
}

/* ===== UIæ›´æ–° ===== */
function show(text, choices=[]){
  const t=document.getElementById("text");
  const c=document.getElementById("choices");
  t.innerHTML=text.replace(/\n/g,"<br>");
  c.innerHTML="";
  choices.forEach(opt=>{
    const b=document.createElement("button");
    b.textContent=opt.text;
    b.onclick=()=>{ playSe("click"); opt.action(); };
    c.appendChild(b);
  });
  document.getElementById("stats").innerHTML=`ğŸ“…${month}æœˆ<br>ğŸ’°${money}å††<br>ğŸ˜Šå¹¸ç¦åº¦:${happy}`;
}

/* ===== ã‚²ãƒ¼ãƒ é€²è¡Œ ===== */
function startGame(){
  setBackground();
  show("ğŸŒ¸4æœˆã«ãªã£ãŸï¼æ˜¥ãŒã‚„ã£ã¦ããŸï¼\næ–°ã—ã„ä¸€å¹´ãŒã¯ã˜ã¾ã‚‹ã‚ˆï¼",[
    {text:"æ¬¡ã¸",action:monthlyEvent}
  ]);
}

/* æœˆåˆã‚¤ãƒ™ãƒ³ãƒˆï¼ˆãƒ©ãƒ³ãƒ€ãƒ ï¼‰ */
function monthlyEvent(){
  setBackground("event");
  const r=Math.random();
  let msg="";
  if(r<0.2){money+=10000;happy+=10;msg="ğŸ‘¨â€ğŸ¦±ãŠã˜ã•ã‚“ãŒæ¥ã¦è‡¨æ™‚ãŠå°é£ã„1ä¸‡å††ï¼å¹¸ç¦åº¦+10";}
  else if(r<0.5){money+=500;happy+=5;msg="ğŸ‘®äº¤ç•ªã«è²¡å¸ƒã‚’å±Šã‘ã¦500å††ï¼å¹¸ç¦åº¦+5";}
  else if(r<0.8){money+=1000;happy+=7;msg="ğŸ‘©ãƒãƒã‚’æ‰‹ä¼ã£ã¦1000å††ã‚‚ã‚‰ãˆãŸï¼å¹¸ç¦åº¦+7";}
  else msg="ç‰¹ã«ä½•ã‚‚ãªã‹ã£ãŸã€‚";
  show(msg,[{text:"ãŠå°é£ã„ã‚’ã‚‚ã‚‰ã†",action:monthlyAllowance}]);
}

/* æ¯æœˆãŠå°é£ã„ */
function monthlyAllowance(){
  money+=3000;
  show("ğŸ’°ä»Šæœˆã®ãŠå°é£ã„3000å††ã‚’ã‚‚ã‚‰ã£ãŸï¼",[{
    text:"ã©ã“ã¸è¡Œãï¼Ÿ",action:chooseShop
  }]);
}

/* ãŠåº—é¸æŠ */
function chooseShop(){
  show("ğŸ™ï¸ã©ã“ã«è¡Œãï¼Ÿ",[
    {text:"ãŠã‚‚ã¡ã‚ƒå±‹",action:toyShop},
    {text:"ãƒ‡ãƒ‘ãƒ¼ãƒˆ",action:departmentStore},
    {text:"ã‚„ã‚ã‚‹",action:monthEvent}
  ]);
}

/* ãŠã‚‚ã¡ã‚ƒå±‹ */
function toyShop(){
  playBgm("event");
  show("ğŸ§¸ãŠã‚‚ã¡ã‚ƒå±‹ã«æ¥ãŸï¼",[ 
    {text:"ãƒ‹ãƒ³ãƒ†ãƒ³ãƒ‰ãƒ¼ã‚¹ã‚¤ãƒƒãƒ(18000å††)",action:()=>buyItem("switch",18000,30)},
    {text:"ã‚²ãƒ¼ãƒ ã‚½ãƒ•ãƒˆ(2000å††)",action:()=>buyItem("game",2000,8)},
    {text:"UFOã‚­ãƒ£ãƒƒãƒãƒ£ãƒ¼ã§éŠã¶(500å††)",action:()=>buyItem("ufo",500,3)},
    {text:"ã‚„ã‚ã‚‹",action:chooseShop}
  ]);
}

/* ãƒ‡ãƒ‘ãƒ¼ãƒˆ */
function departmentStore(){
  playBgm("event");
  show("ğŸ›ï¸ãƒ‡ãƒ‘ãƒ¼ãƒˆã«æ¥ãŸï¼",[ 
    {text:"ã‹ã‚ã„ã„æœ(5000å††)",action:()=>buyItem("clothes",5000,10)},
    {text:"ãƒ—ãƒªã‚­ãƒ¥ã‚¢ã®ãŠã‚‚ã¡ã‚ƒ(2000å††)",action:()=>buyItem("toy",2000,5)},
    {text:"ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ(3000å††)",action:()=>buyItem("gift",3000,8)},
    {text:"ãŠè“å­ã®è©°ã‚åˆã‚ã›(1000å††)",action:()=>buyItem("sweets",1000,4)},
    {text:"ã‚„ã‚ã‚‹",action:chooseShop}
  ]);
}

/* è³¼å…¥å‡¦ç† */
function buyItem(name, price, happyPlus){
  if(money>=price){
    money-=price;
    happy+=happyPlus;
    playSe("buy");
    if(name==="switch")switchBought=true;
    show(`ğŸ›’${price}å††ã§${name==="switch"?"ãƒ‹ãƒ³ãƒ†ãƒ³ãƒ‰ãƒ¼ã‚¹ã‚¤ãƒƒãƒ":"ã‚¢ã‚¤ãƒ†ãƒ "}ã‚’è²·ã£ãŸï¼å¹¸ç¦åº¦+${happyPlus}`,
         [{text:"æˆ»ã‚‹",action:chooseShop}]);
  } else {
    playSe("end");
    show("ğŸ’¦ãŠé‡‘ãŒè¶³ã‚Šãªã„â€¦",[ {text:"æˆ»ã‚‹",action:chooseShop} ]);
  }
}

/* æœˆã‚¤ãƒ™ãƒ³ãƒˆ */
function monthEvent(){
  let msg="";
  switch(month){
    case 4:
      setBackground("event");
      money+=2000;
      msg="ğŸŒ¸å…¥å­¦ç¥ã„ã§2000å††ã‚‚ã‚‰ã£ãŸï¼";
      break;
    case 5:
      setBackground("event");
      show("ğŸ’æ¯ã®æ—¥ï¼ã‚«ãƒ¼ãƒãƒ¼ã‚·ãƒ§ãƒ³(2000å††)ã‚’è²·ã„ã¾ã™ã‹ï¼Ÿ",[
        {text:"è²·ã†",action:()=>{
          if(money>=2000){money-=2000;happy+=10;playSe("buy");
            show("ãŠæ¯ã•ã‚“ãŒå–œã‚“ã ï¼å¹¸ç¦åº¦+10",[ {text:"æ¬¡ã®æœˆã¸",action:nextMonth} ]);
          } else {
            playSe("end");
            show("ğŸ’¦ãŠé‡‘ãŒè¶³ã‚Šãªã‹ã£ãŸâ€¦",[ {text:"æ¬¡ã®æœˆã¸",action:nextMonth} ]);
          }
        }},
        {text:"è²·ã‚ãªã„",action:()=>{show("ğŸ¤”ã¡ã‚‡ã£ã¨ç”³ã—è¨³ãªã„æ°—æŒã¡ã«ãªã£ãŸã€‚",[ {text:"æ¬¡ã®æœˆã¸",action:nextMonth} ]);}}
      ]);
      return;
    case 7:
      msg="ğŸ¦å¤ä¼‘ã¿ï¼ã‚¢ã‚¤ã‚¹ã‚’é£Ÿã¹ã‚‹ï¼Ÿ(100å††Ã—3ã¾ã§)";
      setBackground();
      happy+=3;
      break;
    case 8:
      money+=20000;
      happy+=5;
      msg="ğŸ’°è‡¨æ™‚åå…¥ã ï¼ãªã‚“ã¨2ä¸‡å††ï¼å¹¸ç¦åº¦+5";
      break;
    case 12:
      setBackground();
      show("ğŸ„ã‚¯ãƒªã‚¹ãƒã‚¹ï¼æ¬²ã—ã‹ã£ãŸãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ(20000å††)ã‚’è²·ã†ï¼Ÿ",[
        {text:"è²·ã†",action:()=>{
          if(money>=20000){money-=20000;happy+=50;specialGift=true;playBgm("luxury");
            show("ğŸå¤¢ãŒã‹ãªã£ãŸï¼å¹¸ç¦åº¦+50",[ {text:"ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã¸",action:endGame} ]);
          } else {
            show("ğŸ’¦ãŠé‡‘ãŒè¶³ã‚Šãªãã¦è²·ãˆãªã‹ã£ãŸâ€¦",[ {text:"ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã¸",action:endGame} ]);
          }
        }},
        {text:"è²·ã‚ãªã„",action:endGame}
      ]);
      return;
  }
  show(msg,[{text:"æ¬¡ã®æœˆã¸",action:nextMonth}]);
}

/* æœˆé€²è¡Œ */
function nextMonth(){
  const order = monthOrder;
  const i = order.indexOf(month);
  if(i===order.length-1){ endGame(); return; }
  month = order[i+1];
  playBgm("main");
  setBackground();
  show(`ğŸŒ™ ${month}æœˆã«ãªã£ãŸï¼`,[{text:"æœˆåˆã‚¤ãƒ™ãƒ³ãƒˆã¸",action:monthlyEvent}]);
}

/* ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚° */
function endGame(){
  playBgm("luxury");
  playSe("end");
  setBackground();
  let end="";
  if(specialGift) end="ğŸå¤¢ãŒã‹ãªã£ãŸç‰¹åˆ¥ãªä¸€å¹´ï¼";
  else if(switchBought) end="ğŸ®ã‚¹ã‚¤ãƒƒãƒãƒ©ã‚¤ãƒ•ã‚¨ãƒ³ãƒ‰ï¼";
  else if(happy>=150 && money>=30000) end="ğŸŒŸæœ€é«˜ã®ä¸€å¹´ï¼";
  else if(happy>=150) end="ğŸ˜Šã—ã‚ã‚ã›ã„ã£ã±ã„ã‚¨ãƒ³ãƒ‰ï¼";
  else if(money>=30000) end="ğŸ’°ã—ã£ã‹ã‚Šè²¯ã‚ãŸã‚¨ãƒ³ãƒ‰ï¼";
  else end="ğŸŒ™ãµã¤ã†ã®ä¸€å¹´ã ã£ãŸã­ã€‚";
  show(`ğŸã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°<br>${end}<br><br>ğŸ’°${money}å††<br>ğŸ˜Šå¹¸ç¦åº¦:${happy}`,
       [{text:"ã‚‚ã†ä¸€åº¦ã‚ãã¶",action:()=>location.reload()}]);
}
</script>
</body>
</html>
